#include <iostream>
#include <graphics.h>
#include <windows.h>
#include <time.h>
#include <cmath>
#include <string>

using namespace std;


int main()
{
    
    int a[20][20]={0},i,j,k,l,L,s[10]={0},pk;
    L=200;
    int W,H;
    W=4*L;
    H=4*L;
    initwindow(W,H,"2048");
    for(i=1; i<=4; i++)
        for(j=1; j<=4; j++)
            readimagefile("0.jpg",L*(j-1),L*(i-1),L*j,L*i);
    srand(time(NULL));
    int i1,j1,i2,j2;
    i1=rand()%4+1;
    j1=rand()%4+1;
    if(i1%5==0 || j1%5==0)
        {
         readimagefile("4.jpg",L*(j1-1),L*(i1-1),L*j1,L*i1);
         a[i1][j1]=4;
        }
    else
        {
            readimagefile("2.jpg",L*(j1-1),L*(i1-1),L*j1,L*i1);
            a[i1][j1]=2;
        }
    do
    {
        i2=rand()%4+1;
        j2=rand()%4+1;
    }
    while(i1!=i2 && j1!=j2);
    if(i1%5==0 || j1%5==0)
        {
            readimagefile("4.jpg",L*(j2-1),L*(i2-1),L*j2,L*i2);
            a[i2][j2]=4;
        }
    else
        {
            readimagefile("2.jpg",L*(j2-1),L*(i2-1),L*j2,L*i2);
            a[i2][j2]=2;
        }

    ///VERIFICARE INITIALA LA CONSOLA
    cout<<endl;
    for(k=1;k<=4;k++)
        {
        for(l=1;l<=4;l++)
             cout<<a[k][l]<<" ";
        cout<<endl;
        }
    cout<<endl;
    int ok=1;
    char ch;
    ch=getch();
    while(ok==1)
    {
        ch=getch();
        ///STANGA--------------------------------------------------
        if(ch==KEY_LEFT)
        {
            for(i=1; i<=4; i++)
                s[i]=0;
            for(i=1; i<=4; i++)
                if (a[i][1]==0 && a[i][2]==0 && a[i][3]==0 && a[i][4]!=0)///CAZUL 1
                {
                    s[i]=1;
                    a[i][1]=a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==2)
                        readimagefile("2.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                }
                else if (a[i][1]==0 && a[i][2]==0 && a[i][3]!=0 && a[i][4]==0)///CAZUL 2
                {
                    s[i]=1;
                    a[i][1]=a[i][3];
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][1]==2)
                        readimagefile("2.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                }
                else if (a[i][1]==0 && a[i][2]!=0 && a[i][3]==0 && a[i][4]==0)///CAZUL 3
                {
                    s[i]=1;
                    a[i][1]=a[i][2];
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][1]==2)
                        readimagefile("2.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                }
                else if(a[i][1]==a[i][2] && a[i][2]!=0 && a[i][3]==0 && a[i][4]==0)///CAZUL 4
                {
                    s[i]=1;
                    a[i][1]=2*a[i][2];
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }
                }
                else if(a[i][1]==a[i][3] && a[i][3]!=0 && a[i][2]==0 && a[i][4]==0)///CAZUL 5
                {
                    s[i]=1;
                    a[i][1]=2*a[i][3];
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }
                }
                else if(a[i][1]==a[i][4] && a[i][4]!=0 && a[i][2]==0 && a[i][3]==0)///CAZUL 6
                {
                    s[i]=1;
                    a[i][1]=2*a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }
                }
                else if(a[i][2]==a[i][3] && a[i][3]!=0 && a[i][1]==0 && a[i][4]==0)///CAZUL 7
                {
                    s[i]=1;
                    a[i][1]=2*a[i][2];
                    a[i][2]=0;
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }
                }
                else if(a[i][2]==a[i][4] && a[i][4]!=0 && a[i][3]==0 && a[i][1]==0)///CAZUL 8
                {
                    s[i]=1;
                    a[i][1]=2*a[i][2];
                    a[i][2]=0;
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }
                }
                else if(a[i][3]==a[i][4] && a[i][4]!=0 && a[i][2]==0 && a[i][1]==0)///CAZUL 9
                {
                    s[i]=1;
                    a[i][1]=2*a[i][3];
                    a[i][3]=0;
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }
                }
                else if (a[i][1]!=0 && a[i][2]==0 && a[i][3]!=0 && a[i][4]==0 && a[i][1]!=a[i][3])///CAZUL 10
                {
                    s[i]=1;
                    a[i][2]=a[i][3];
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                }
                else if (a[i][1]!=0 && a[i][2]==0 && a[i][3]==0 && a[i][4]!=0 && a[i][4]!=a[i][1])///CAZUL 11
                {
                    s[i]=1;
                    a[i][2]=a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                }
                else if (a[i][1]==0 && a[i][2]!=0 && a[i][3]!=0 && a[i][4]==0 && a[i][2]!=a[i][3])///CAZUL 12
                {
                    s[i]=1;
                    a[i][1]=a[i][2];
                    a[i][2]=a[i][3];
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][1]==2)
                        readimagefile("2.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);


                }
                else if (a[i][1]==0 && a[i][2]!=0 && a[i][3]==0 && a[i][4]!=0 && a[i][4]!=a[i][2])///CAZUL 13
                {
                    s[i]=1;
                    a[i][1]=a[i][2];
                    a[i][2]=a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==2)
                        readimagefile("2.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);

                }
                else if (a[i][1]==0 && a[i][2]==0 && a[i][3]!=0 && a[i][4]!=0 && a[i][3]!=a[i][4])///CAZUL 14
                {
                    s[i]=1;
                    a[i][1]=a[i][3];
                    a[i][2]=a[i][4];
                    a[i][4]=0;
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==2)
                        readimagefile("2.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);

                }
                else if(a[i][1]==a[i][2] && a[i][2]!=0 && a[i][3]!=0 && a[i][4]==0 )///CAZUL 15
                {
                    s[i]=1;
                    a[i][1]=2*a[i][2];
                    a[i][2]=a[i][3];
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);


                }
                else if(a[i][2]==a[i][3] && a[i][1]!=0 && a[i][3]!=0 && a[i][3]!=a[i][1] && a[i][4]==0)///CAZUL 16
                {
                    s[i]=1;
                    a[i][2]=2*a[i][2];
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==2048)
                    {
                        readimagefile("2048.jpg",L*(2-1),L*(i-1),L*2,L*i);
                        ok=2048;
                    }


                }
                else if(a[i][2]==a[i][4] && a[i][1]!=0 && a[i][4]!=0 && a[i][2]!=a[i][1] && a[i][3]==0)///CAZUL 17
                {
                    s[i]=1;
                    a[i][2]=2*a[i][2];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==2048)
                    {
                        readimagefile("2048.jpg",L*(2-1),L*(i-1),L*2,L*i);
                        ok=2048;
                    }


                }
                else if(a[i][1]==a[i][2] && a[i][2]!=0 && a[i][3]==0 && a[i][4]!=0)///CAZUL 18
                {
                    s[i]=1;
                    a[i][1]=2*a[i][2];
                    a[i][2]=a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);


                }
                else if (a[i][1]!=0 && a[i][2]!=0 && a[i][2]!=a[i][1] && a[i][2]!=a[i][4] && a[i][3]==0 && a[i][4]!=0)///CAZUL 19
                {
                    s[i]=1;
                    a[i][3]=a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);
                }
                else if(a[i][1]==a[i][3] && a[i][3]!=0 && a[i][4]!=0 && a[i][2]==0)///CAZUL 20
                {
                    s[i]=1;
                    a[i][1]=2*a[i][3];
                    a[i][2]=a[i][4];
                    a[i][4]=0;
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);


                }
                else if(a[i][3]==a[i][4] && a[i][1]!=0 && a[i][4]!=0 && a[i][3]!=a[i][1] && a[i][2]==0)///CAZUL 21
                {
                    s[i]=1;
                    a[i][2]=2*a[i][3];
                    a[i][4]=0;
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==2048)
                    {
                        readimagefile("2048.jpg",L*(2-1),L*(i-1),L*2,L*i);
                        ok=2048;
                    }

                }
                else if(a[i][1]!=0 && a[i][3]!=0 && a[i][4]!=0 && a[i][3]!=a[i][1] && a[i][3]!=a[i][4] && a[i][2]==0)///CAZUL 22
                {
                    s[i]=1;
                    a[i][2]=a[i][3];
                    a[i][3]=a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);

                }
                else if(a[i][3]==a[i][2] && a[i][1]==0 && a[i][3]!=0 && a[i][4]!=0)///CAZUL 23
                {
                    s[i]=1;
                    a[i][1]=2*a[i][2];
                    a[i][2]=a[i][4];
                    a[i][3]=0;
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);


                }
                else if(a[i][4]==a[i][3] && a[i][3]!=0 && a[i][3]!=a[i][2] && a[i][1]==0 && a[i][2]!=0)///CAZUL 24
                {
                    s[i]=1;
                    a[i][1]=a[i][2];
                    a[i][2]=a[i][3]*2;
                    a[i][3]=0;
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==2)
                        readimagefile("2.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);

                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==2048)
                    {
                        readimagefile("2048.jpg",L*(2-1),L*(i-1),L*2,L*i);
                        ok=2048;
                    }

                }
                else if(a[i][1]==0 && a[i][3]!=0 && a[i][4]!=0 && a[i][3]!=a[i][2] && a[i][3]!=a[i][4] && a[i][2]!=0)///CAZUL 25
                {
                    s[i]=1;
                    a[i][1]=a[i][2];
                    a[i][2]=a[i][3];
                    a[i][3]=a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==2)
                        readimagefile("2.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);

                }
                else if(a[i][1]==a[i][2] && a[i][2]!=0 && a[i][3]!=0 && a[i][4]!=0 && a[i][4]!=a[i][3])///CAZUL 26
                {
                    s[i]=1;
                    a[i][1]=2*a[i][2];
                    a[i][2]=a[i][3];
                    a[i][3]=a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);


                }
                else if(a[i][2]==a[i][3] && a[i][1]!=0 && a[i][3]!=0 && a[i][3]!=a[i][1] && a[i][4]!=0)///CAZUL 27
                {
                    s[i]=1;
                    a[i][2]=2*a[i][2];
                    a[i][3]=a[i][4];
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==2048)
                    {
                        readimagefile("2048.jpg",L*(2-1),L*(i-1),L*2,L*i);
                        ok=2048;
                    }

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);


                }

                else if(a[i][1]!=0 && a[i][2]!=0 && a[i][3]!=a[i][2] && a[i][3]==a[i][4] && a[i][1]!=a[i][2] && a[i][3]!=0)///CAZUL 28
                {
                    s[i]=1;
                    a[i][3]=a[i][3]*2;
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==2048)
                    {
                        readimagefile("2048.jpg",L*(3-1),L*(i-1),L*3,L*i);
                        ok=2048;
                    }


                }
                else if(a[i][1]==a[i][2] && a[i][1]!=0 && a[i][3]==a[i][4] && a[i][3]!=0)///CAZUL 29
                {
                    s[i]=1;
                    a[i][1]=a[i][1]*2;
                    a[i][2]=a[i][3]*2;
                    a[i][3]=0;
                    a[i][4]=0;
                    readimagefile("0.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][1]==4)
                        readimagefile("4.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==8)
                        readimagefile("8.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==16)
                        readimagefile("16.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==32)
                        readimagefile("32.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==64)
                        readimagefile("64.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==128)
                        readimagefile("128.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==256)
                        readimagefile("256.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==512)
                        readimagefile("512.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==1024)
                        readimagefile("1024.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][1]==2048)
                    {
                        readimagefile("2048.jpg",L*(1-1),L*(i-1),L*1,L*i);
                        ok=2048;
                    }

                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==2048)
                    {
                        readimagefile("2048.jpg",L*(2-1),L*(i-1),L*2,L*i);
                        ok=2048;
                    }
                }
            pk=0;
            for(i=1; i<=4; i++)
                for(j=1; j<=4; j++)
                    if(a[i][j]!=0)
                        pk=1;
            if((s[1]==1 || s[2]==1 || s[3]==1 || s[4]==1) && pk==1)
            {
                srand(time(NULL));
                do
                {
                    i=rand()%4+1;
                    j=rand()%4+1;
                }
                while(a[i][j]!=0);
                if(rand()%7==0)
                {
                    a[i][j]=4;
                    readimagefile("4.jpg",L*(j-1),L*(i-1),L*j,L*i);
                }
                else
                {
                    a[i][j]=2;
                    readimagefile("2.jpg",L*(j-1),L*(i-1),L*j,L*i);
                }
            }
            ///VERIFICARE LA CONSOLA (OPTIONAL)
            cout<<endl;
            for(k=1;k<=4;k++)
                  {
                    for(l=1;l<=4;l++)
                        cout<<a[k][l]<<" ";
                    cout<<endl;
                  }
            if(ok==2048)
            {
                readimagefile("yes.jpg",0,0,800,800);
                delay(1000);
            }
            else if(ok==1)
            {
                ok=0;
                for(i=1; i<=4; i++)
                    for(j=1; j<=4; j++)
                        if(a[i][j]==0 || (a[i-1][j]==a[i][j] || a[i][j-1]==a[i][j] || a[i+1][j]==a[i][j] || a[i][j+1]==a[i][j]))
                            ok=1;
            }
            if(ok==0)
                readimagefile("no.jpg",0,0,800,800);
        }
        else if(ch==KEY_RIGHT)
        {
            for(i=1; i<=4; i++)
                s[i]=0;
            ///DREAPTA________________________
            for(i=1; i<=4; i++)
                if (a[i][4]==0 && a[i][3]==0 && a[i][2]==0 && a[i][1]!=0)///CAZUL 1
                {
                    s[i]=1;
                    a[i][4]=a[i][1];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==2)
                        readimagefile("2.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);



                }
                else if (a[i][4]==0 && a[i][3]==0 && a[i][2]!=0 && a[i][1]==0)///CAZUL 2
                {
                    s[i]=1;
                    a[i][4]=a[i][2];
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][4]==2)
                        readimagefile("2.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);


                }
                else if (a[i][4]==0 && a[i][3]!=0 && a[i][2]==0 && a[i][1]==0)///CAZUL 3
                {
                    s[i]=1;
                    a[i][4]=a[i][3];
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][4]==2)
                        readimagefile("2.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);


                }
                else if(a[i][4]==a[i][3] && a[i][3]!=0 && a[i][2]==0 && a[i][1]==0)///CAZUL 4
                {
                    s[i]=1;
                    a[i][4]=2*a[i][3];
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }


                }
                else if(a[i][4]==a[i][2] && a[i][2]!=0 && a[i][3]==0 && a[i][1]==0)///CAZUL 5
                {
                    s[i]=1;
                    a[i][4]=2*a[i][2];
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                }
                else if(a[i][4]==a[i][1] && a[i][1]!=0 && a[i][3]==0 && a[i][2]==0)///CAZUL 6
                {
                    s[i]=1;
                    a[i][4]=2*a[i][4];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                }
                else if(a[i][2]==a[i][3] && a[i][3]!=0 && a[i][1]==0 && a[i][4]==0)///CAZUL 7
                {
                    s[i]=1;
                    a[i][4]=2*a[i][2];
                    a[i][2]=0;
                    a[i][3]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                }
                else if(a[i][3]==a[i][1] && a[i][1]!=0 && a[i][2]==0 && a[i][4]==0)///CAZUL 8
                {
                    s[i]=1;
                    a[i][4]=2*a[i][3];
                    a[i][3]=0;
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }


                }
                else if(a[i][2]==a[i][1] && a[i][1]!=0 && a[i][3]==0 && a[i][4]==0)///CAZUL 9
                {
                    s[i]=1;
                    a[i][4]=2*a[i][2];
                    a[i][2]=0;
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                }
                else if (a[i][4]!=0 && a[i][3]==0 && a[i][2]!=0 && a[i][1]==0 && a[i][4]!=a[i][2])///CAZUL 10
                {
                    s[i]=1;
                    a[i][3]=a[i][2];
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);

                }
                else if (a[i][4]!=0 && a[i][3]==0 && a[i][2]==0 && a[i][1]!=0 && a[i][4]!=a[i][1])///CAZUL 11
                {
                    s[i]=1;
                    a[i][3]=a[i][1];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);

                }
                else if (a[i][4]==0 && a[i][3]!=0 && a[i][2]!=0 && a[i][1]==0 && a[i][2]!=a[i][3])///CAZUL 12
                {
                    s[i]=1;
                    a[i][4]=a[i][3];
                    a[i][3]=a[i][2];
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][4]==2)
                        readimagefile("2.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);


                }
                else if (a[i][4]==0 && a[i][3]!=0 && a[i][2]==0 && a[i][1]!=0 && a[i][1]!=a[i][3])///CAZUL 13
                {
                    s[i]=1;
                    a[i][4]=a[i][3];
                    a[i][3]=a[i][1];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==2)
                        readimagefile("2.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);

                }
                else if (a[i][4]==0 && a[i][3]==0 && a[i][2]!=0 && a[i][1]!=0 && a[i][2]!=a[i][1])///CAZUL 14
                {
                    s[i]=1;
                    a[i][4]=a[i][2];
                    a[i][3]=a[i][1];
                    a[i][1]=0;
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==2)
                        readimagefile("2.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);

                }
                else if(a[i][4]==a[i][3] && a[i][3]!=0 && a[i][2]!=0 && a[i][1]==0 )///CAZUL 15
                {
                    s[i]=1;
                    a[i][4]=2*a[i][4];
                    a[i][3]=a[i][2];
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);


                }
                else if(a[i][2]==a[i][3] && a[i][4]!=0 && a[i][2]!=0 && a[i][2]!=a[i][4] && a[i][1]==0)///CAZUL 16
                {
                    s[i]=1;
                    a[i][3]=2*a[i][2];
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==2048)
                    {
                        readimagefile("2048.jpg",L*(3-1),L*(i-1),L*3,L*i);
                        ok=2048;
                    }


                }
                else if(a[i][3]==a[i][1] && a[i][4]!=0 && a[i][1]!=0 && a[i][3]!=a[i][4] && a[i][2]==0)///CAZUL 17
                {
                    s[i]=1;
                    a[i][3]=2*a[i][3];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==2048)
                    {
                        readimagefile("2048.jpg",L*(3-1),L*(i-1),L*3,L*i);
                        ok=2048;
                    }


                }
                else if(a[i][4]==a[i][3] && a[i][3]!=0 && a[i][2]==0  && a[i][1]!=0)///CAZUL 18
                {
                    s[i]=1;
                    a[i][4]=2*a[i][3];
                    a[i][3]=a[i][1];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);


                }
                else if (a[i][4]!=0 && a[i][3]!=0 && a[i][3]!=a[i][4] && a[i][3]!=a[i][1] && a[i][2]==0 && a[i][1]!=0)///CAZUL 19
                {
                    s[i]=1;
                    a[i][2]=a[i][1];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                }
                else if(a[i][4]==a[i][2] && a[i][2]!=0 && a[i][1]!=0 && a[i][3]==0)///CAZUL 20
                {
                    s[i]=1;
                    a[i][4]=2*a[i][2];
                    a[i][3]=a[i][1];
                    a[i][1]=0;
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);
                }
                else if(a[i][2]==a[i][1] && a[i][4]!=0 && a[i][1]!=0 && a[i][2]!=a[i][4] && a[i][3]==0)///CAZUL 21
                {
                    s[i]=1;
                    a[i][3]=2*a[i][2];
                    a[i][1]=0;
                    a[i][2]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==2048)
                    {
                        readimagefile("2048.jpg",L*(3-1),L*(i-1),L*3,L*i);
                        ok=2048;
                    }

                }
                else if(a[i][4]!=0 && a[i][3]==0 && a[i][1]!=0 && a[i][2]!=a[i][4] && a[i][2]!=a[i][1] && a[i][2]!=0)///CAZUL 22
                {
                    s[i]=1;
                    a[i][3]=a[i][2];
                    a[i][2]=a[i][1];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);

                }
                else if(a[i][2]==a[i][3] && a[i][4]==0 && a[i][2]!=0 && a[i][1]!=0)///CAZUL 23
                {
                    s[i]=1;
                    a[i][4]=2*a[i][3];
                    a[i][3]=a[i][1];
                    a[i][2]=0;
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);


                }
                else if(a[i][1]==a[i][2] && a[i][2]!=0 && a[i][3]!=a[i][2] && a[i][4]==0 && a[i][3]!=0)///CAZUL 24
                {
                    s[i]=1;
                    a[i][4]=a[i][3];
                    a[i][3]=a[i][2]*2;
                    a[i][2]=0;
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==2)
                        readimagefile("2.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);

                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==2048)
                    {
                        readimagefile("2048.jpg",L*(3-1),L*(i-1),L*3,L*i);
                        ok=2048;
                    }

                }
                else if(a[i][4]==0 && a[i][2]!=0 && a[i][1]!=0 && a[i][2]!=a[i][3] && a[i][2]!=a[i][1] && a[i][3]!=0)///CAZUL 25
                {
                    s[i]=1;
                    a[i][4]=a[i][3];
                    a[i][3]=a[i][2];
                    a[i][2]=a[i][1];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==2)
                        readimagefile("2.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);

                }
                else if(a[i][4]==a[i][3] && a[i][3]!=0 && a[i][2]!=0 && a[i][1]!=0 && a[i][1]!=a[i][2])///CAZUL 26
                {
                    s[i]=1;
                    a[i][4]=2*a[i][3];
                    a[i][3]=a[i][2];
                    a[i][2]=a[i][1];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);

                    if(a[i][3]==2)
                        readimagefile("2.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);


                }
                else if(a[i][2]==a[i][3] && a[i][4]!=0 && a[i][2]!=0 && a[i][2]!=a[i][4] && a[i][1]!=0)///CAZUL 27
                {
                    s[i]=1;
                    a[i][3]=2*a[i][3];
                    a[i][2]=a[i][1];
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==2048)
                    {
                        readimagefile("2048.jpg",L*(3-1),L*(i-1),L*3,L*i);
                        ok=2048;
                    }

                    if(a[i][2]==2)
                        readimagefile("2.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                }
                else if(a[i][4]!=0 && a[i][3]!=0 && a[i][2]!=a[i][3] && a[i][2]==a[i][1] && a[i][4]!=a[i][3] && a[i][2]!=0)///CAZUL 28
                {
                    s[i]=1;
                    a[i][2]=a[i][2]*2;
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    if(a[i][2]==4)
                        readimagefile("4.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==8)
                        readimagefile("8.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==16)
                        readimagefile("16.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==32)
                        readimagefile("32.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==64)
                        readimagefile("64.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==128)
                        readimagefile("128.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==256)
                        readimagefile("256.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==512)
                        readimagefile("512.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==1024)
                        readimagefile("1024.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][2]==2048)
                    {
                        readimagefile("2048.jpg",L*(2-1),L*(i-1),L*2,L*i);
                        ok=2048;
                    }


                }
                else if(a[i][4]==a[i][3] && a[i][4]!=0 && a[i][2]==a[i][1] && a[i][2]!=0)///CAZUL 29
                {
                    s[i]=1;
                    a[i][4]=a[i][4]*2;
                    a[i][3]=a[i][2]*2;
                    a[i][2]=0;
                    a[i][1]=0;
                    readimagefile("0.jpg",L*(1-1),L*(i-1),L*1,L*i);
                    readimagefile("0.jpg",L*(2-1),L*(i-1),L*2,L*i);
                    if(a[i][4]==4)
                        readimagefile("4.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==8)
                        readimagefile("8.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==16)
                        readimagefile("16.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==32)
                        readimagefile("32.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==64)
                        readimagefile("64.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==128)
                        readimagefile("128.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==256)
                        readimagefile("256.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==512)
                        readimagefile("512.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==1024)
                        readimagefile("1024.jpg",L*(4-1),L*(i-1),L*4,L*i);
                    if(a[i][4]==2048)
                    {
                        readimagefile("2048.jpg",L*(4-1),L*(i-1),L*4,L*i);
                        ok=2048;
                    }

                    if(a[i][3]==4)
                        readimagefile("4.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==8)
                        readimagefile("8.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==16)
                        readimagefile("16.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==32)
                        readimagefile("32.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==64)
                        readimagefile("64.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==128)
                        readimagefile("128.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==256)
                        readimagefile("256.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==512)
                        readimagefile("512.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==1024)
                        readimagefile("1024.jpg",L*(3-1),L*(i-1),L*3,L*i);
                    if(a[i][3]==2048)
                    {
                        readimagefile("2048.jpg",L*(3-1),L*(i-1),L*3,L*i);
                        ok=2048;
                    }
                }

            pk=0;
            for(i=1; i<=4; i++)
                for(j=1; j<=4; j++)
                    if(a[i][j]!=0)
                        pk=1;
            if((s[1]==1 || s[2]==1 || s[3]==1 || s[4]==1)&& pk==1)
            {
                srand(time(NULL));
                do
                {
                    i=rand()%4+1;
                    j=rand()%4+1;
                }
                while(a[i][j]!=0);
                if(rand()%7==0)
                {
                    a[i][j]=4;
                    readimagefile("4.jpg",L*(j-1),L*(i-1),L*j,L*i);
                }
                else
                {
                    a[i][j]=2;
                    readimagefile("2.jpg",L*(j-1),L*(i-1),L*j,L*i);
                }
            }
            ///VERIFICARE LA CONSOLA
            cout<<endl;
            for(k=1;k<=4;k++)
                {
                for(l=1;l<=4;l++)
                      cout<<a[k][l]<<" ";
                cout<<endl;
                }
            if(ok==2048)
                readimagefile("yes.jpg",0,0,800,800);
            else if(ok==1)
            {
                ok=0;
                for(i=1; i<=4; i++)
                    for(j=1; j<=4; j++)
                        if(a[i][j]==0 || (a[i-1][j]==a[i][j] || a[i][j-1]==a[i][j] || a[i+1][j]==a[i][j] || a[i][j+1]==a[i][j]))
                            ok=1;
            }
            if(ok==0)
                readimagefile("no.jpg",0,0,800,800);
        }///ACOLADA DE LA IF
        ///SUUUUUUUUUUUUUUUUUUUUS
        else if(ch==KEY_UP)
        {
            for(i=1; i<=4; i++)
                s[i]=0;
            for(j=1; j<=4; j++)
                if (a[1][j]==0 && a[2][j]==0 && a[3][j]==0 && a[4][j]!=0)///CAZUL 1
                {
                    s[j]=1;
                    a[1][j]=a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);


                }
                else if (a[1][j]==0 && a[2][j]==0 && a[3][j]!=0 && a[4][j]==0)///CAZUL 2
                {
                    s[j]=1;
                    a[1][j]=a[3][j];
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[1][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);


                }
                else if (a[1][j]==0 && a[2][j]!=0 && a[3][j]==0 && a[4][j]==0)///CAZUL 3
                {
                    s[j]=1;
                    a[1][j]=a[2][j];
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[1][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                }
                else if(a[1][j]==a[2][j] && a[2][j]!=0 && a[3][j]==0 && a[4][j]==0)///CAZUL 4
                {
                    s[j]=1;
                    a[1][j]=2*a[2][j];
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }


                }

                else if(a[1][j]==a[3][j] && a[3][j]!=0 && a[2][j]==0 && a[4][j]==0)///CAZUL 5
                {
                    s[j]=1;
                    a[1][j]=2*a[3][j];
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }

                }

                else if(a[1][j]==a[4][j] && a[4][j]!=0 && a[2][j]==0 && a[3][j]==0)///CAZUL 6
                {
                    s[j]=1;
                    a[1][j]=2*a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }

                }
                else if(a[2][j]==a[3][j] && a[3][j]!=0 && a[1][j]==0 && a[4][j]==0)///CAZUL 7
                {
                    s[j]=1;
                    a[1][j]=2*a[2][j];
                    a[2][j]=0;
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }

                }
                else if(a[2][j]==a[4][j] && a[4][j]!=0 && a[3][j]==0 && a[1][j]==0)///CAZUL 8
                {
                    s[j]=1;
                    a[1][j]=2*a[2][j];
                    a[2][j]=0;
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }


                }
                else if(a[3][j]==a[4][j] && a[4][j]!=0 && a[2][j]==0 && a[1][j]==0)///CAZUL 9
                {
                    s[j]=1;
                    a[1][j]=2*a[3][j];
                    a[3][j]=0;
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }

                }
                else if (a[1][j]!=0 && a[2][j]==0 && a[3][j]!=0 && a[4][j]==0 && a[1][j]!=a[3][j])///CAZUL 10
                {
                    s[j]=1;
                    a[2][j]=a[3][j];
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                }

                else if (a[1][j]!=0 && a[2][j]==0 && a[3][j]==0 && a[4][j]!=0 && a[4][j]!=a[1][j])///CAZUL 11
                {
                    s[j]=1;
                    a[2][j]=a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                }
                else if (a[1][j]==0 && a[2][j]!=0 && a[3][j]!=0 && a[4][j]==0 && a[2][j]!=a[3][j])///CAZUL 12
                {
                    s[j]=1;
                    a[1][j]=a[2][j];
                    a[2][j]=a[3][j];
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[1][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);

                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);
                }
                else if (a[1][j]==0 && a[2][j]!=0 && a[3][j]==0 && a[4][j]!=0 && a[4][j]!=a[2][j])///CAZUL 13
                {
                    s[j]=1;
                    a[1][j]=a[2][j];
                    a[2][j]=a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);

                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                }
                else if (a[1][j]==0 && a[2][j]==0 && a[3][j]!=0 && a[4][j]!=0 && a[3][j]!=a[4][j])///CAZUL 14
                {
                    s[j]=1;
                    a[1][j]=a[3][j];
                    a[2][j]=a[4][j];
                    a[3][j]=0;
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);


                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                }
                else if(a[1][j]==a[2][j] && a[2][j]!=0 && a[3][j]!=0 && a[4][j]==0 )///CAZUL 15
                {
                    s[j]=1;
                    a[1][j]=2*a[2][j];
                    a[2][j]=a[3][j];
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }

                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);


                }
                else if(a[2][j]==a[3][j] && a[1][j]!=0 && a[3][j]!=0 && a[3][j]!=a[1][j] && a[4][j]==0)///CAZUL 16
                {
                    s[j]=1;
                    a[2][j]=2*a[2][j];
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(2-1),L*j,L*2);
                        ok=2048;
                    }
                }
                else if(a[2][j]==a[4][j] && a[1][j]!=0 && a[4][j]!=0 && a[2][j]!=a[1][j] && a[3][j]==0)///CAZUL 17
                {
                    s[j]=1;
                    a[2][j]=2*a[2][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(2-1),L*j,L*2);
                        ok=2048;
                    }


                }
                else if(a[1][j]==a[2][j] && a[2][j]!=0 && a[3][j]==0 && a[4][j]!=0)///CAZUL 18
                {
                    s[j]=1;
                    a[1][j]=2*a[2][j];
                    a[2][j]=a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }

                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);


                }
                else if (a[1][j]!=0 && a[2][j]!=0 && a[2][j]!=a[1][j] && a[2][j]!=a[4][j] && a[3][j]==0 && a[4][j]!=0)///CAZUL 19
                {
                    s[j]=1;
                    a[3][j]=a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);

                }
                else if(a[1][j]==a[3][j] && a[3][j]!=0 && a[4][j]!=0 && a[2][j]==0)///CAZUL 20
                {
                    s[j]=1;
                    a[1][j]=2*a[3][j];
                    a[2][j]=a[4][j];
                    a[4][j]=0;
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }

                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);
                }
                else if(a[3][j]==a[4][j] && a[1][j]!=0 && a[4][j]!=0 && a[3][j]!=a[1][j] && a[2][j]==0)///CAZUL 21
                {
                    s[j]=1;
                    a[2][j]=2*a[3][j];
                    a[4][j]=0;
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(2-1),L*j,L*2);
                        ok=2048;
                    }

                }
                else if(a[1][j]!=0 && a[3][j]!=0 && a[4][j]!=0 && a[3][j]!=a[1][j] && a[3][j]!=a[4][j] && a[2][j]==0)///CAZUL 22
                {
                    s[j]=1;
                    a[2][j]=a[3][j];
                    a[3][j]=a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);


                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);

                }
                else if(a[3][j]==a[2][j] && a[1][j]==0 && a[3][j]!=0 && a[4][j]!=0)///CAZUL 23
                {
                    s[j]=1;
                    a[1][j]=2*a[2][j];
                    a[2][j]=a[4][j];
                    a[3][j]=0;
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }


                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);


                }
                else if(a[4][j]==a[3][j] && a[3][j]!=0 && a[3][j]!=a[2][j] && a[1][j]==0 && a[2][j]!=0)///CAZUL 24
                {
                    s[j]=1;
                    a[1][j]=a[2][j];
                    a[2][j]=a[3][j]*2;
                    a[3][j]=0;
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);

                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(2-1),L*j,L*2);
                        ok=2048;
                    }

                }
                else if(a[1][j]==0 && a[3][j]!=0 && a[4][j]!=0 && a[3][j]!=a[2][j] && a[3][j]!=a[4][j] && a[2][j]!=0)///CAZUL 25
                {
                    s[j]=1;
                    a[1][j]=a[2][j];
                    a[2][j]=a[3][j];
                    a[3][j]=a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);

                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);

                }
                else if(a[1][j]==a[2][j] && a[2][j]!=0 && a[3][j]!=0 && a[4][j]!=0 && a[4][j]!=a[3][j])///CAZUL 26
                {
                    s[j]=1;
                    a[1][j]=2*a[2][j];
                    a[2][j]=a[3][j];
                    a[3][j]=a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }

                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);


                }
                else if(a[2][j]==a[3][j] && a[1][j]!=0 && a[3][j]!=0 && a[3][j]!=a[1][j] && a[4][j]!=0)///CAZUL 27
                {
                    s[j]=1;
                    a[2][j]=2*a[2][j];
                    a[3][j]=a[4][j];
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(2-1),L*j,L*2);
                        ok=2048;
                    }

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                }

                else if(a[1][j]!=0 && a[2][j]!=0 && a[3][j]!=a[2][j] && a[3][j]==a[4][j] && a[1][j]!=a[2][j] && a[3][j]!=0)///CAZUL 28
                {
                    s[j]=1;
                    a[3][j]=a[3][j]*2;
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(3-1),L*j,L*3);
                        ok=2048;
                    }
                }
                else if(a[1][j]==a[2][j] && a[1][j]!=0 && a[3][j]==a[4][j] && a[3][j]!=0)///CAZUL 29
                {
                    s[j]=1;
                    a[1][j]=a[1][j]*2;
                    a[2][j]=a[3][j]*2;
                    a[3][j]=0;
                    a[4][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[1][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[1][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(1-1),L*j,L*1);
                        ok=2048;
                    }

                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(2-1),L*j,L*2);
                        ok=2048;
                    }
                }
            pk=0;
            for(i=1; i<=4; i++)
                for(j=1; j<=4; j++)
                    if(a[i][j]!=0)
                        pk=1;
            if((s[1]==1 || s[2]==1 || s[3]==1 || s[4]==1) && pk==1)
            {
                srand(time(NULL));
                do
                {
                    i=rand()%4+1;
                    j=rand()%4+1;
                }
                while(a[i][j]!=0);
                if(rand()%7==0)
                {
                    a[i][j]=4;
                    readimagefile("4.jpg",L*(j-1),L*(i-1),L*j,L*i);
                }
                else
                {
                    a[i][j]=2;
                    readimagefile("2.jpg",L*(j-1),L*(i-1),L*j,L*i);
                }
            }
            cout<<endl;
            for(k=1;k<=4;k++)
                 {
                 for(l=1;l<=4;l++)
                    cout<<a[k][l]<<" ";
                 cout<<endl;
                 }

            if(ok==2048)
                readimagefile("yes.jpg",0,0,800,800);
            else if(ok==1)
            {
                ok=0;
                for(i=1; i<=4; i++)
                    for(j=1; j<=4; j++)
                        if(a[i][j]==0 || (a[i-1][j]==a[i][j] || a[i][j-1]==a[i][j] || a[i+1][j]==a[i][j] || a[i][j+1]==a[i][j]))
                            ok=1;

            }
            if(ok==0)
                readimagefile("no.jpg",0,0,800,800);
        }
        ///JOOOOOOOOOOOOOOOOOSSSSSSSSSS----------------
        else if(ch==KEY_DOWN)
        {
            for(i=1; i<=4; i++)
                s[i]=0;
            for(j=1; j<=4; j++)
                if (a[4][j]==0 && a[3][j]==0 && a[2][j]==0 && a[1][j]!=0)///CAZUL 1
                {
                    s[j]=1;
                    a[4][j]=a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);


                }
                else if (a[4][j]==0 && a[3][j]==0 && a[2][j]!=0 && a[1][j]==0)///CAZUL 2
                {
                    s[j]=1;
                    a[4][j]=a[2][j];
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[4][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);


                }
                else if (a[1][j]==0 && a[3][j]!=0 && a[2][j]==0 && a[4][j]==0)///CAZUL 3
                {
                    s[j]=1;
                    a[4][j]=a[3][j];
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[4][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                }
                else if(a[4][j]==a[3][j] && a[3][j]!=0 && a[2][j]==0 && a[1][j]==0)///CAZUL 4
                {
                    s[j]=1;
                    a[4][j]=2*a[3][j];
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }


                }

                else if(a[4][j]==a[2][j] && a[2][j]!=0 && a[3][j]==0 && a[1][j]==0)///CAZUL 5
                {
                    s[j]=1;
                    a[4][j]=2*a[2][j];
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }

                }

                else if(a[1][j]==a[4][j] && a[4][j]!=0 && a[2][j]==0 && a[3][j]==0)///CAZUL 6
                {
                    s[j]=1;
                    a[4][j]=2*a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }

                }
                else if(a[2][j]==a[3][j] && a[3][j]!=0 && a[1][j]==0 && a[4][j]==0)///CAZUL 7
                {
                    s[j]=1;
                    a[4][j]=2*a[3][j];
                    a[2][j]=0;
                    a[3][j]=0;
                    readimagefile("0.jpg",L*(2-1),L*(j-1),L*2,L*j);
                    readimagefile("0.jpg",L*(3-1),L*(j-1),L*3,L*j);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }

                }
                else if(a[3][j]==a[1][j] && a[1][j]!=0 && a[2][j]==0 && a[4][j]==0)///CAZUL 8
                {
                    s[j]=1;
                    a[4][j]=2*a[3][j];
                    a[3][j]=0;
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }


                }
                else if(a[2][j]==a[1][j] && a[1][j]!=0 && a[3][j]==0 && a[4][j]==0)///CAZUL 9
                {
                    s[j]=1;
                    a[4][j]=2*a[2][j];
                    a[2][j]=0;
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }

                }
                else if (a[4][j]!=0 && a[3][j]==0 && a[2][j]!=0 && a[1][j]==0 && a[4][j]!=a[2][j])///CAZUL 10
                {
                    s[j]=1;
                    a[3][j]=a[2][j];
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);

                }

                else if (a[4][j]!=0 && a[3][j]==0 && a[2][j]==0 && a[1][j]!=0 && a[4][j]!=a[1][j])///CAZUL 11
                {
                    s[j]=1;
                    a[3][j]=a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);

                }
                else if (a[1][j]==0 && a[2][j]!=0 && a[3][j]!=0 && a[4][j]==0 && a[2][j]!=a[3][j])///CAZUL 12
                {
                    s[j]=1;
                    a[4][j]=a[3][j];
                    a[3][j]=a[2][j];
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[4][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                }
                else if (a[4][j]==0 && a[3][j]!=0 && a[2][j]==0 && a[1][j]!=0 && a[1][j]!=a[3][j])///CAZUL 13
                {
                    s[j]=1;
                    a[4][j]=a[3][j];
                    a[3][j]=a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);

                }
                else if (a[4][j]==0 && a[3][j]==0 && a[2][j]!=0 && a[1][j]!=0 && a[2][j]!=a[1][j])///CAZUL 14
                {
                    s[j]=1;
                    a[4][j]=a[2][j];
                    a[3][j]=a[1][j];
                    a[1][j]=0;
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[4][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);


                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);

                }
                else if(a[4][j]==a[3][j] && a[3][j]!=0 && a[2][j]!=0 && a[1][j]==0 )///CAZUL 15
                {
                    s[j]=1;
                    a[4][j]=2*a[3][j];
                    a[3][j]=a[2][j];
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);


                }
                else if(a[2][j]==a[3][j] && a[4][j]!=0 && a[3][j]!=0 && a[3][j]!=a[4][j] && a[1][j]==0)///CAZUL 16
                {
                    s[j]=1;
                    a[3][j]=2*a[2][j];
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(3-1),L*j,L*3);
                        ok=2048;
                    }
                }
                else if(a[3][j]==a[1][j] && a[4][j]!=0 && a[1][j]!=0 && a[3][j]!=a[4][j] && a[2][j]==0)///CAZUL 17
                {
                    s[j]=1;
                    a[3][j]=2*a[3][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(3-1),L*j,L*3);
                        ok=2048;
                    }


                }
                else if(a[4][j]==a[3][j] && a[3][j]!=0 && a[2][j]==0 && a[1][j]!=0)///CAZUL 18
                {
                    s[j]=1;
                    a[4][j]=2*a[3][j];
                    a[3][j]=a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);


                }
                else if (a[4][j]!=0 && a[3][j]!=0 && a[3][j]!=a[4][j] && a[3][j]!=a[1][j] && a[2][j]==0 && a[1][j]!=0)///CAZUL 19
                {
                    s[j]=1;
                    a[2][j]=a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                }
                else if(a[4][j]==a[j][2] && a[2][j]!=0 && a[1][j]!=0 && a[3][j]==0)///CAZUL 20
                {
                    s[j]=1;
                    a[4][j]=2*a[2][j];
                    a[3][j]=a[1][j];
                    a[2][j]=0;
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                }
                else if(a[2][j]==a[1][j] && a[4][j]!=0 && a[1][j]!=0 && a[2][j]!=a[4][j] && a[3][j]==0)///CAZUL 21
                {
                    s[j]=1;
                    a[3][j]=2*a[2][j];
                    a[1][j]=0;
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(3-1),L*j,L*3);
                        ok=2048;
                    }

                }
                else if(a[4][j]!=0 && a[2][j]!=0 && a[1][j]!=0 && a[2][j]!=a[4][j] && a[2][j]!=a[1][j] && a[3][j]==0)///CAZUL 22
                {
                    s[j]=1;
                    a[3][j]=a[2][j];
                    a[2][j]=a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);


                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                }
                else if(a[3][j]==a[2][j] && a[4][j]==0 && a[2][j]!=0 && a[1][j]!=0)///CAZUL 23
                {
                    s[j]=1;
                    a[4][j]=2*a[3][j];
                    a[3][j]=a[1][j];
                    a[1][j]=0;
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }


                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);


                }
                else if(a[1][j]==a[2][j] && a[2][j]!=0 && a[3][j]!=a[2][j] && a[4][j]==0 && a[3][j]!=0)///CAZUL 24
                {
                    s[j]=1;
                    a[4][j]=a[3][j];
                    a[3][j]=a[2][j]*2;
                    a[1][j]=0;
                    a[2][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);

                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(3-1),L*j,L*3);
                        ok=2048;
                    }

                }
                else if(a[4][j]==0 && a[2][j]!=0 && a[1][j]!=0 && a[3][j]!=a[2][j] && a[2][j]!=a[1][j] && a[3][j]!=0)///CAZUL 25
                {
                    s[j]=1;
                    a[4][j]=a[3][j];
                    a[3][j]=a[2][j];
                    a[2][j]=a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);

                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                }
                else if(a[4][j]==a[3][j] && a[3][j]!=0 && a[2][j]!=0 && a[1][j]!=0 && a[1][j]!=a[2][j])///CAZUL 26
                {
                    s[j]=1;
                    a[4][j]=2*a[3][j];
                    a[3][j]=a[2][j];
                    a[2][j]=a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }

                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                    if(a[3][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);


                }
                else if(a[2][j]==a[3][j] && a[4][j]!=0 && a[3][j]!=0 && a[2][j]!=a[4][j] && a[1][j]!=0)///CAZUL 27
                {
                    s[j]=1;
                    a[3][j]=2*a[3][j];
                    a[2][j]=a[1][j];
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[2][j]==2)
                        readimagefile("2.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);

                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(3-1),L*j,L*3);
                        ok=2048;
                    }
                }

                else if(a[4][j]!=0 && a[3][j]!=0 && a[3][j]!=a[2][j] && a[2][j]==a[1][j] && a[4][j]!=a[3][j] && a[2][j]!=0)///CAZUL 28
                {
                    s[j]=1;
                    a[2][j]=a[2][j]*2;
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[2][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    if(a[2][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(2-1),L*j,L*2);
                        ok=2048;
                    }
                }
                else if(a[4][j]==a[3][j] && a[4][j]!=0 && a[2][j]==a[1][j] && a[2][j]!=0)///CAZUL 29
                {
                    s[j]=1;
                    a[4][j]=a[4][j]*2;
                    a[3][j]=a[2][j]*2;
                    a[2][j]=0;
                    a[1][j]=0;
                    readimagefile("0.jpg",L*(j-1),L*(2-1),L*j,L*2);
                    readimagefile("0.jpg",L*(j-1),L*(1-1),L*j,L*1);
                    if(a[4][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(4-1),L*j,L*4);
                    if(a[4][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(4-1),L*j,L*4);
                        ok=2048;
                    }

                    if(a[3][j]==4)
                        readimagefile("4.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==8)
                        readimagefile("8.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==16)
                        readimagefile("16.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==32)
                        readimagefile("32.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==64)
                        readimagefile("64.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==128)
                        readimagefile("128.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==256)
                        readimagefile("256.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==512)
                        readimagefile("512.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==1024)
                        readimagefile("1024.jpg",L*(j-1),L*(3-1),L*j,L*3);
                    if(a[3][j]==2048)
                    {
                        readimagefile("2048.jpg",L*(j-1),L*(3-1),L*j,L*3);
                        ok=2048;
                    }
                }
            pk=0;
            for(i=1; i<=4; i++)
                for(j=1; j<=4; j++)
                    if(a[i][j]!=0)
                        pk=1;
            if((s[1]==1 || s[2]==1 || s[3]==1 || s[4]==1) && pk==1)
            {
                srand(time(NULL));
                do
                {
                    i=rand()%4+1;
                    j=rand()%4+1;
                }
                while(a[i][j]!=0);
                if(rand()%7==0)
                {
                    a[i][j]=4;
                    readimagefile("4.jpg",L*(j-1),L*(i-1),L*j,L*i);
                }
                else
                {
                    a[i][j]=2;
                    readimagefile("2.jpg",L*(j-1),L*(i-1),L*j,L*i);
                }
            }
            ///VERIFICARE LA CONSOLA
            cout<<endl;
            for(k=1;k<=4;k++)
                  {
                   for(l=1;l<=4;l++)
                      cout<<a[k][l]<<" ";
                   cout<<endl;
                  }
            if(ok==2048)
                readimagefile("yes.jpg",0,0,800,800);
            else if(ok==1)
            {
                ok=0;
                for(i=1; i<=4; i++)
                    for(j=1; j<=4; j++)
                        if(a[i][j]==0 || (a[i-1][j]==a[i][j] || a[i][j-1]==a[i][j] || a[i+1][j]==a[i][j] || a[i][j+1]==a[i][j]))
                            ok=1;

            }
            if(ok==0)
                readimagefile("no.jpg",0,0,800,800);


        }
   
   




    }///ACOLADA DE LA WHILE




























    delay(100000);
    return 0;
}
